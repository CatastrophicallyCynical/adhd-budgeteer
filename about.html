<!doctype html><html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>About ¬∑ Budgeteer</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .swatches{display:flex; flex-wrap:wrap; gap:8px}
    /* thick border so White is visible, inner highlight helps dark chips */
    .dot{width:28px;height:28px;border-radius:50%;
         border:2px solid rgba(0,0,0,.35); box-shadow:inset 0 0 0 2px rgba(255,255,255,.35);
         cursor:pointer}
    .dot[aria-selected="true"]{outline:2px solid #111827; outline-offset:2px}
  </style>
</head>
<body>
<header>
  <div class="app-title">About</div>
  <div class="affirmation small"></div>
</header>

<div class="container">
  <div class="card">
    <div class="row" style="align-items:center">
      <div style="font-size:36px; line-height:1">‚ù§Ô∏è</div>
      <button class="btn" id="backBtn">Back</button>
    </div>
    <h2>Built with care by James for Cameron</h2>
    <div><em>You're worth every bit of frustration this code was.</em></div>
    <hr>
    <div class="small" id="ver"></div>
  </div>

  <div class="card">
    <div style="font-weight:700; margin-bottom:8px">Theme</div>
    <div class="small" style="margin-bottom:8px">Tap a color to apply instantly (and save).</div>

    <div class="row"><div>Background</div><div class="swatches" id="bgRow"></div></div>
    <div class="row"><div>Panels</div><div class="swatches" id="panelRow"></div></div>
    <div class="row"><div>Text</div><div class="swatches" id="inkRow"></div></div>

    <div class="actions" style="justify-content:center; margin-top:12px">
      <button class="btn" id="resetTheme">Reset to default</button>
    </div>
  </div>

  <div class="card">
    <div class="actions" style="justify-content:center">
      <button class="btn" id="export">Export settings</button>
      <button class="btn" id="import">Import settings</button>
    </div>
  </div>

  <!-- Danger Zone with extra bottom margin so it never hides under the tab bar -->
  <div class="card mb-safe">
    <div style="font-weight:700; margin-bottom:8px">Danger zone</div>
    <button class="btn" id="wipe">Delete all local data</button>
  </div>
</div>

<nav class="tabbar">
  <a href="index.html"><span class="ico">üè†</span><span>Home</span></a>
  <a href="expense.html"><span class="ico">‚ûñ</span><span>Expense</span></a>
  <a href="income.html"><span class="ico">‚ûï</span><span>Income</span></a>
  <a href="recurring.html"><span class="ico">üîÅ</span><span>Recurring</span></a>
  <a href="history.html"><span class="ico">üìú</span><span>History</span></a>
  <a href="about.html"><span class="ico">‚öôÔ∏è</span><span>About</span></a>
</nav>

<script>
/* This About page is self-contained. It uses localStorage like your simplified app.js. */
const THEME_KEY = 'budgeteer_meta';
const DEFAULT_THEME = 'blue'; // mapped in CSS (alias of navy)

function loadMeta(){
  try{ return JSON.parse(localStorage.getItem(THEME_KEY)) || { theme: DEFAULT_THEME, version: 1 }; }
  catch{ return { theme: DEFAULT_THEME, version: 1 }; }
}
function saveMeta(m){ localStorage.setItem(THEME_KEY, JSON.stringify(m)); }

function applyThemeName(name){
  document.body.setAttribute('data-theme', name);
  const meta = loadMeta(); meta.theme = name; saveMeta(meta);
}

/* Palette chips ‚Äî these pick predefined data-theme names */
const THEME_NAMES = ['white','black','sky','grass','lemon','coral','lavender','mint','sand','slate','rose','navy','blue'];

function renderThemeRow(rowId){
  const row = document.getElementById(rowId);
  row.innerHTML = '';
  const active = document.body.getAttribute('data-theme') || loadMeta().theme || DEFAULT_THEME;

  for (const name of THEME_NAMES){
    const chip = document.createElement('button');
    chip.className = 'dot';
    chip.setAttribute('aria-label', name);
    chip.setAttribute('aria-selected', name===active ? 'true' : 'false');
    chip.style.background = themePreviewColor(name);
    chip.onclick = ()=>{
      // Apply the global theme immediately
      applyThemeName(name);
      // Update selected styling
      document.querySelectorAll('.dot[aria-selected="true"]').forEach(d=>d.setAttribute('aria-selected','false'));
      chip.setAttribute('aria-selected','true');
    };
    row.appendChild(chip);
  }
}

/* crude preview color swatch per theme name */
function themePreviewColor(name){
  switch(name){
    case 'white': return '#ffffff';
    case 'black': return '#0b0b0b';
    case 'sky': return '#4FC3F7';
    case 'grass': return '#81C784';
    case 'lemon': return '#FFD54F';
    case 'coral': return '#FF8A65';
    case 'lavender': return '#BA68C8';
    case 'mint': return '#4DB6AC';
    case 'sand': return '#FBC02D';
    case 'slate': return '#90A4AE';
    case 'rose': return '#F48FB1';
    case 'navy':
    case 'blue': return '#3949AB';
    default: return '#e5e7eb';
  }
}

/* Export/Import (localStorage blob) */
function exportSettings(){
  const out = {
    budgeteer_meta: loadMeta(),
    budgeteer_expenses: JSON.parse(localStorage.getItem('budgeteer_expenses')||'[]'),
    budgeteer_income: JSON.parse(localStorage.getItem('budgeteer_income')||'[]'),
    budgeteer_recurring: JSON.parse(localStorage.getItem('budgeteer_recurring')||'[]'),
  };
  const blob = new Blob([JSON.stringify(out,null,2)], {type:'application/json'});
  const a = Object.assign(document.createElement('a'), {href:URL.createObjectURL(blob), download:'budgeteer-backup.json'}); a.click();
}
function importSettings(){
  const input = Object.assign(document.createElement('input'), {type:'file', accept:'application/json'});
  input.onchange = async ()=>{
    try{
      const text = await input.files[0].text();
      const data = JSON.parse(text);
      if (data.budgeteer_meta) localStorage.setItem('budgeteer_meta', JSON.stringify(data.budgeteer_meta));
      if (data.budgeteer_expenses) localStorage.setItem('budgeteer_expenses', JSON.stringify(data.budgeteer_expenses));
      if (data.budgeteer_income) localStorage.setItem('budgeteer_income', JSON.stringify(data.budgeteer_income));
      if (data.budgeteer_recurring) localStorage.setItem('budgeteer_recurring', JSON.stringify(data.budgeteer_recurring));
      // apply imported theme immediately
      const meta = loadMeta(); document.body.setAttribute('data-theme', meta.theme || DEFAULT_THEME);
      alert('Imported!');
      renderThemeRow('bgRow'); renderThemeRow('panelRow'); renderThemeRow('inkRow');
    }catch(e){ alert('Import failed.'); }
  };
  input.click();
}

/* Danger Zone */
function wipeAll(){
  if (!confirm('Are you sure?? This deletes all local Budgeteer data.')) return;
  if (!confirm('ARE YOU SURE DUDE?? This cannot be undone.')) return;
  localStorage.clear();
  location.reload();
}

/* Back button */
document.getElementById('backBtn').onclick = ()=> history.back();

/* Version text (best effort) */
document.getElementById('ver').textContent = `Local data ‚Ä¢ ${new Date().toLocaleString()}`;

/* Wire buttons */
document.getElementById('export').onclick = exportSettings;
document.getElementById('import').onclick = importSettings;
document.getElementById('resetTheme').onclick = ()=>{
  applyThemeName(DEFAULT_THEME);
  renderThemeRow('bgRow'); renderThemeRow('panelRow'); renderThemeRow('inkRow');
};
document.getElementById('wipe').onclick = wipeAll;

/* init: apply saved theme and render swatches */
(function init(){
  const meta = loadMeta();
  document.body.setAttribute('data-theme', meta.theme || DEFAULT_THEME);
  renderThemeRow('bgRow');
  renderThemeRow('panelRow');
  renderThemeRow('inkRow');
})();
</script>
</body></html>
