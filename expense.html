<!doctype html><html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Add Expense · Budgeteer</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<script src="theme-apply.js"></script>
<div class="container">
  <div class="card">
    <h2>Add Expense</h2>

    <label>Amount (use negative, e.g. -12.50)</label>
    <input type="number" id="amount" step="0.01" placeholder="-0.00">

    <label>Date</label>
    <input type="date" id="date">

    <label>Bucket</label>
    <select id="bucket"></select>

    <label>Note (optional)</label>
    <input type="text" id="note" placeholder="What did money do?">

    <div class="actions">
      <button class="btn" id="cancel">Cancel</button>
      <button class="btn primary" id="save">Save</button>
    </div>
  </div>
</div>

<nav class="tabbar">
  <a href="index.html"><span class="ico">🏠</span><span>Home</span></a>
  <a href="expense.html"><span class="ico">➖</span><span>Expense</span></a>
  <a href="income.html"><span class="ico">➕</span><span>Income</span></a>
  <a href="history.html"><span class="ico">📜</span><span>History</span></a>
  <a href="about.html"><span class="ico">⚙️</span><span>About</span></a>
</nav>

<script>
const LS_EXP='budgeteer_expenses';
const LS_BUCKETS='budgeteer_buckets';

function load(key, def){ try{ return JSON.parse(localStorage.getItem(key)) ?? def; }catch{ return def; } }
function save(key,val){ localStorage.setItem(key, JSON.stringify(val)); }

document.getElementById('date').value = new Date().toISOString().slice(0,10);

// buckets + preselect
const sel = document.getElementById('bucket');
(load(LS_BUCKETS, [])).forEach(b=>{
  const opt = document.createElement('option');
  opt.value = b.id; opt.textContent = `${b.emoji} ${b.name}`;
  sel.appendChild(opt);
});
const pre = new URLSearchParams(location.search).get('bucket'); if (pre) sel.value = pre;

document.getElementById('cancel').onclick = ()=> history.back();
document.getElementById('save').onclick = ()=>{
  const amt = Number((document.getElementById('amount').value||'').trim());
  if (!amt) { alert('Enter an amount (negative number for expense)'); return; }
  const date = document.getElementById('date').value || new Date().toISOString().slice(0,10);
  const bucketId = sel.value;
  const note = document.getElementById('note').value || '';

  const all = load(LS_EXP, []);
  all.push({ id: crypto.randomUUID(), amount: amt, bucketId, note, date });
  save(LS_EXP, all);
  alert('Saved!');
  history.back();
};
</script>
</body></html>
